<!-- Session Status Tabs -->
<div class="flex border-b border-gray-200 mb-6">
  @for (tab of sessionTabs; track tab) {
    <button
      (click)="selectSessionTab(tab)"
      class="px-6 py-3 text-sm font-medium transition-all duration-150 border-b-2"
      [ngClass]="{
        'text-blue-600 border-blue-600': selectedSessionTab === tab,
        'text-gray-500 border-transparent hover:text-gray-700 hover:border-gray-300': selectedSessionTab !== tab
      }"
    >
      <span>{{ tab }}</span>
      @if (tab === 'Upcoming') {
        <span class="ml-2 bg-red-500 text-white text-xs px-2 py-0.5 rounded-full font-medium">{{ getUpcomingCount() }}</span>
      }
    </button>
  }
</div>

@if (selectedSessionTab === 'Notes') {
  <app-notes></app-notes>
} @else {
  <div class="space-y-2">
    @for (session of filteredSessions; track session.title) {
      <div class="group relative bg-white rounded-xl border border-gray-200 shadow-sm hover:shadow-lg hover:-translate-y-0.5 transition-all duration-300 p-5 cursor-pointer">
        
        <div class="flex items-center gap-5">
          <!-- Mentor Avatar -->
          <div class="relative flex-shrink-0">
            <img [src]="session.mentorAvatar" [alt]="session.mentor" class="w-12 h-12 rounded-full object-cover shadow-md">
            <div class="absolute -bottom-1 -right-1 w-4 h-4 bg-green-500 rounded-full border-2 border-white"></div>
          </div>
          
          <!-- Enhanced Session Info -->
          <div class="flex-1 min-w-0">
            <div class="flex items-start justify-between mb-2">
              <div class="flex-1">
                <h3 class="font-bold text-lg text-gray-900 group-hover:text-blue-600 transition-colors duration-200 truncate pr-4">{{ session.title }}</h3>
                <div class="flex items-center gap-2 mt-1">
                  <span class="text-sm font-medium text-gray-700">{{ session.mentor }}</span>
                  <div class="w-1 h-1 bg-gray-400 rounded-full"></div>
                  <span class="text-sm text-gray-500">{{ session.duration }}</span>
                </div>
              </div>
              <div class="text-right flex-shrink-0">
                <span class="text-sm font-medium text-blue-600">{{ session.bookingId }}</span>
                <p class="text-xs text-gray-500 mt-0.5">Booking ID</p>
              </div>
            </div>
            
            <!-- Session Meta -->
            <div class="flex items-center gap-4 mb-3">
              <div class="flex items-center gap-1.5 text-sm text-gray-600">
                <i class="ri-calendar-line text-gray-500"></i>
                <span>{{ session.date }}</span>
              </div>
              <div class="flex items-center gap-1.5 text-sm text-gray-600">
                <i class="ri-time-line text-gray-500"></i>
                <span>{{ session.time }}</span>
              </div>
              @if (session.status === 'completed' && session.rating) {
                <div class="flex items-center gap-1.5 text-sm text-gray-600">
                  <i class="ri-star-fill text-yellow-500"></i>
                  <span>{{ session.rating }} rating</span>
                </div>
              }
            </div>
            
            <!-- Enhanced Tags & Level -->
            <div class="flex items-center gap-2 flex-wrap">
              <span class="inline-flex items-center text-xs font-semibold px-2.5 py-1 rounded-full border"
                [ngClass]="{
                  'bg-emerald-50 text-emerald-700 border-emerald-200': session.level === 'Beginner',
                  'bg-amber-50 text-amber-700 border-amber-200': session.level === 'Intermediate',
                  'bg-rose-50 text-rose-700 border-rose-200': session.level === 'Advanced'
                }">
                <i class="ri-star-line mr-1"></i>
                {{ session.level }}
              </span>
              @for (tag of session.tags.slice(0, 2); track tag) {
                <span class="inline-flex items-center text-xs font-medium bg-slate-100 text-slate-700 px-2.5 py-1 rounded-full border border-slate-200 hover:bg-slate-200 transition-colors duration-150">
                  {{ tag }}
                </span>
              }
              @if (session.tags.length > 2) {
                <span class="inline-flex items-center text-xs font-medium bg-blue-50 text-blue-700 px-2.5 py-1 rounded-full border border-blue-200">
                  +{{ session.tags.length - 2 }} more
                </span>
              }
            </div>
          </div>
          
          <!-- Action Button -->
          <div class="flex-shrink-0">
            @if (session.status === 'upcoming') {
              <button class="bg-green-600 hover:bg-green-700 text-white px-6 py-2.5 rounded-lg font-medium text-sm shadow-sm hover:shadow-md transition-all duration-200">
                <i class="ri-video-line mr-2"></i>
                Join Session
              </button>
            } @else {
              <div class="flex flex-col gap-1">
                <div class="flex items-center gap-2 text-sm text-gray-500 bg-gray-50 px-4 py-2 rounded-lg border border-gray-200">
                  <i class="ri-check-line text-green-500"></i>
                  <span class="font-medium">Completed</span>
                </div>
                <button class="text-xs text-blue-600 hover:text-blue-700 font-medium">
                  Rate Session
                </button>
              </div>
            }
          </div>
        </div>
      </div>
    }
  </div>
}
